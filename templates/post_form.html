{% extends "base.html" %}

{% block title %}{% if post %}Edit Post{% else %}Create Post{% endif %} - PhotoMark{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/post-form.css') }}">
{% endblock %}

{% block content %}
<div class="form-container">
    <header class="form-header">
        <h1>{% if post %}Edit Post{% else %}Create Post{% endif %}</h1>
    </header>
    
    <form method="POST" enctype="multipart/form-data" class="post-form">
        <div class="form-group">
            <label for="title">Title</label>
            <input type="text" id="title" name="title" 
                   value="{% if post %}{{ post.title }}{% endif %}" 
                   placeholder="Enter post title..." required>
        </div>
        
        <div class="form-group">
            <label for="content">Content</label>
            <textarea id="content" name="content" rows="8" 
                      placeholder="Write your post content here..." required>{% if post %}{{ post.content }}{% endif %}</textarea>
        </div>
        
        <div class="form-group">
            <label for="image">Image <span class="optional">(optional)</span></label>
            <div class="file-upload-wrapper">
                <input type="file" id="image" name="image" accept="image/*">
                <label for="image" class="file-upload-label">
                    <i class="fas fa-image"></i> Choose image
                </label>
            </div>
            {% if post and post.image_filename %}
                <div class="current-image">
                    <img src="{{ url_for('static', filename='uploads/' + post.image_filename) }}" 
                         alt="Current image">
                    <span class="image-replace-text">Upload a new image to replace</span>
                </div>
            {% endif %}
        </div>
        
        <div class="form-actions">
            <a href="{% if post %}{{ url_for('view_post', post_id=post.id) }}{% else %}{{ url_for('index') }}{% endif %}" 
               class="btn-secondary">Cancel</a>
            <button type="submit" class="btn-primary">
                {% if post %}Update Post{% else %}Create Post{% endif %}
            </button>
        </div>
    </form>
</div>

<script>
// Show selected file name
document.getElementById('image').addEventListener('change', function(e) {
    const label = document.querySelector('.file-upload-label');
    if (this.files && this.files[0]) {
        label.innerHTML = '<i class="fas fa-check"></i> ' + this.files[0].name;
    } else {
        label.innerHTML = '<i class="fas fa-image"></i> Choose image';
    }
});
</script>
{% endblock %}

